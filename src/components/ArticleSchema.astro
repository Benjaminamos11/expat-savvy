---
/**
 * ArticleSchema.astro
 * LLM & SEO Optimization: Provides structured data for Articles and Guides.
 * Helps search engines (Google) and AI crawlers (Perplexity/OpenAI) understand content.
 */

interface Props {
    title: string;
    description: string;
    image: string;
    author?:
        | string
        | {
              "@type": string;
              name: string;
              url?: string;
              affiliation?: {
                  "@type": string;
                  name: string;
              };
          };
    publishDate?: string;
    modifiedDate?: string;
}

const {
    title,
    description,
    image,
    author = "Hans Steiner",
    publishDate = "2026-01-28T12:00:00Z",
    modifiedDate = new Date().toISOString(),
} = Astro.props;

const authorSchema =
    typeof author === "string"
        ? {
              "@type": "Person",
              name: author,
              url: "https://expat-savvy.ch/about/hans-steiner/", // Updated to deep link
          }
        : author;

const articleSchema = {
    "@context": "https://schema.org",
    "@type": "Article",
    headline: title,
    description: description,
    image: image.startsWith("http") ? image : `https://expat-savvy.ch${image}`,
    author: authorSchema,
    publisher: {
        "@type": "Organization",
        name: "Expat Savvy",
        logo: {
            "@type": "ImageObject",
            url: "https://expat-savvy.ch/favicon.png",
        },
    },
    datePublished: publishDate,
    dateModified: modifiedDate,
    mainEntityOfPage: {
        "@type": "WebPage",
        "@id": Astro.url.href,
    },
};
---

<script type="application/ld+json" set:html={JSON.stringify(articleSchema)} />
