---
import Layout from '../layouts/Layout.astro';
import Testimonials from '../components/Testimonials.astro';
import { getCollection } from 'astro:content';

const stats = [
  { number: "1000+", label: "Happy Clients" },
  { number: "100%", label: "English Support" },
  { number: "Independent", label: "Insurance Broker" },
  { number: "20+", label: "Years Experience" }
];

const valuePoints = [
  {
    icon: `<svg class="h-8 w-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" />
    </svg>`,
    title: "FINMA-Certified Expertise",
    description: "Over 10 years helping expats in Switzerland navigate insurance decisions. FINMA-certified advisors with deep Swiss insurance knowledge and international perspective."
  },
  {
    icon: `<svg class="h-8 w-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 6l3 1m0 0l-3 9a5.002 5.002 0 006.001 0M6 7l3 9M6 7l6-2m6 2l3-1m-3 1l-3 9a5.002 5.002 0 006.001 0M18 7l3 9m-3-9l-6-2m0-2v2m0 16V5m0 16H9m3 0h3" />
    </svg>`,
    title: "Fully Independent Advice",
    description: "We compare the entire Swiss insurance market to find what's best for you. Our recommendations are based on your needs, not insurance company commissions."
  },
  {
    icon: `<svg class="h-8 w-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z" />
    </svg>`,
    title: "Long-Term Partnership",
    description: "We actively monitor your coverage and reach out when better options arise. Your peace of mind through every life change is our priority."
  }
];

const whyExpatSavvyPoints = [
  {
    icon: `<svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" />
    </svg>`,
    title: "Independent Advice",
    description: "We compare all major Swiss insurers to find the right fit for you."
  },
  {
    icon: `<svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z" />
    </svg>`,
    title: "Expat Expertise",
    description: "We understand the challenges of moving to Switzerland, including language barriers and pre-existing conditions."
  },
  {
    icon: `<svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1" />
    </svg>`,
    title: "Save Time & Money",
    description: "Clear comparisons and smart optimizations, without the guesswork."
  },
  {
    icon: `<svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
    </svg>`,
    title: "Personal Support",
    description: "A dedicated advisor guides setup, switching, and special cases."
  }
];

const reviews = [
  {
    text: "Moving to Switzerland was overwhelming, but Expat Savvy made insurance so simple. They saved me over 2000 CHF annually!",
    author: "Sarah Thompson",
    role: "Software Engineer from UK"
  },
  {
    text: "Their holistic approach helped me understand exactly what coverage I needed. Best decision I made after moving to ZÃ¼rich.",
    author: "Marco Rossi",
    role: "Finance Professional from Italy"
  },
  {
    text: "As a family of four, we needed comprehensive coverage. They found us the perfect balance of protection and cost.",
    author: "Jennifer Chen",
    role: "Research Scientist from Singapore"
  }
];

const premiumPartners = [
  {
    name: "Prime Relocation",
    logo: "https://cdn.prod.website-files.com/6718b88a9ad8ce0f3ec5e7a6/672df357ed71370900ec04cb_output-onlinepngtools-p-800.png",
    url: "https://www.primerelocation.ch",
    description: "Expert relocation services for expats moving to Switzerland"
  }
];

// Get blog posts for featured section
const allBlogPosts = await getCollection('blog');
const validPosts = allBlogPosts
  .filter(post => post.data.title && post.data.description) // Only include posts with complete data
  .sort((a, b) => {
    const dateA = a.data.date instanceof Date ? a.data.date : new Date(a.data.date || 0);
    const dateB = b.data.date instanceof Date ? b.data.date : new Date(b.data.date || 0);
    return dateB.getTime() - dateA.getTime();
  });

// Function to get random selection of blog posts
function getRandomPosts(posts: any[], count: number) {
  const shuffled = [...posts].sort(() => 0.5 - Math.random());
  return shuffled.slice(0, count);
}

// Always show random posts (we'll rotate them with JavaScript)
const initialPosts = getRandomPosts(validPosts, 3);

// Pass all valid posts to the client for rotation
const allPostsForRotation = validPosts.map(post => ({
  slug: post.slug,
  title: post.data.title,
  description: post.data.description,
  image: post.data.image,
  date: post.data.date
}));

// Default image for posts without images
const defaultBlogImage = "https://res.cloudinary.com/dphbnwjtx/image/upload/v1746849106/a-hand-drawn-style-illustration-of-a-swi_q72d2DQuS9GBc1WmPIaaCw_008krU2iTMW5Xa_C75c0rQ_ud00f1.webp";

// Helper function to format dates
const formatDate = (date: Date | string | undefined | null): string => {
  if (!date) return '';
  
  try {
    const dateObj = date instanceof Date ? date : 
                  (typeof date === 'string' ? new Date(date) : null);
    
    if (!dateObj || isNaN(dateObj.valueOf())) return '';
    
    return dateObj.toLocaleDateString('en-US', {
      year: 'numeric',
      month: 'long',
      day: 'numeric'
    });
  } catch (error) {
    console.error('Error formatting date:', error);
    return '';
  }
};
---

<Layout
  title="Health Insurance in Switzerland for Expats | Your Partner"
  description="We help expats in Switzerland set up or switch health insurance. Personal, English-speaking advice with free consultations."
>
  <!-- Hero Section -->
  <div class="relative min-h-[50vh] md:min-h-[90vh] flex items-center overflow-hidden hero-section">
    <div class="absolute inset-0">
      <img 
        src="https://res.cloudinary.com/dphbnwjtx/image/upload/v1746960418/a-photograph-depicts-a-pair-of-youthful-_quYJOYFeRPqWWfrG0MYelw_ndQb4IxjRbGazkFfjfLXNA_qk6hxm.webp"
        alt="Swiss mountains"
        class="w-full h-full object-cover"
      />
      <div class="absolute inset-0 bg-gradient-to-r from-black/50 to-black/30"></div>
    </div>
    
    <!-- Mobile layout (centered) -->
    <div class="relative w-full mx-auto px-4 sm:px-6 md:hidden py-8">
      <div class="text-center">
        <h1 class="text-3xl sm:text-4xl font-extrabold text-white mb-3 animate-fade-in text-shadow">
          <span class="block">Your Partner for Health Insurance</span>
          <span class="block mt-1">in Switzerland</span>
        </h1>
        <p class="mt-3 text-base sm:text-lg text-white animate-slide-up text-shadow">
          Your trusted partner for all your insurance needs in Switzerland. Expert guidance in English, tailored to expats like you.
        </p>
        <div class="mt-6 flex flex-col items-center gap-3 animate-slide-up">
          <button
            data-open-consultation="true" 
            class="inline-flex items-center px-5 py-2.5 sm:px-6 sm:py-3 border border-transparent text-base font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 transition-colors duration-300 shadow-lg hover:shadow-xl"
            onclick="event.preventDefault(); if(typeof window.openOffersModal === 'function') { window.openOffersModal(); } else { const modal = document.getElementById('offers-modal'); if(modal) { modal.classList.remove('hidden'); document.body.classList.add('modal-open'); } } return false;"
          >
            Book Free Consultation
            <svg class="ml-2 h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 5l7 7m0 0l-7 7m7-7H3" />
            </svg>
          </button>
          <div class="flex items-center justify-center text-sm text-white mt-2 w-full">
            <div class="inline-flex items-center bg-green-900/30 py-1 px-3 rounded-full backdrop-blur-sm">
            <svg class="h-4 w-4 text-green-400 mr-2 animate-pulse" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
              <span id="booking-count" class="whitespace-nowrap">8 people booked a consultation in the last 24 hours</span>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Desktop layout (left aligned) -->
    <div class="relative w-full mx-auto hidden md:block">
      <div class="grid grid-cols-12 gap-4">
        <div class="col-span-6 col-start-2 flex items-center justify-center">
          <div class="text-left max-w-xl">
            <h1 class="text-5xl md:text-6xl font-extrabold text-white mb-6 animate-fade-in text-shadow">
              <span class="block">Your Partner for Health Insurance</span>
              <span class="block mt-2">in Switzerland</span>
            </h1>
            <p class="mt-6 text-xl text-white animate-slide-up text-shadow">
              Your trusted partner for all your insurance needs in Switzerland. Expert guidance in English, tailored to expats like you.
            </p>
            <div class="mt-10 flex flex-col items-start gap-4 animate-slide-up">
              <button
                data-open-consultation="true" 
                class="inline-flex items-center px-8 py-4 border border-transparent text-lg font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 transition-colors duration-300 shadow-lg hover:shadow-xl"
                onclick="event.preventDefault(); if(typeof window.openOffersModal === 'function') { window.openOffersModal(); } else { const modal = document.getElementById('offers-modal'); if(modal) { modal.classList.remove('hidden'); document.body.classList.add('modal-open'); } } return false;"
              >
                Book Free Consultation
                <svg class="ml-2 h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 5l7 7m0 0l-7 7m7-7H3" />
                </svg>
              </button>
              <div class="flex items-center text-sm text-white">
                <div class="inline-flex items-center bg-green-900/30 py-1 px-3 rounded-full backdrop-blur-sm">
                <svg class="h-4 w-4 text-green-400 mr-2 animate-pulse" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
                  <span id="booking-count-desktop" class="whitespace-nowrap">8 people booked a consultation in the last 24 hours</span>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="col-span-6"></div>
      </div>
    </div>
  </div>

  <!-- Trust Indicators -->
  <div class="bg-white py-6 sm:py-12 trust-indicators">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="grid grid-cols-2 md:grid-cols-4 gap-4 md:gap-8 text-center">
        {stats.map(stat => (
          <div class="flex flex-col items-center">
            <span class="text-3xl md:text-4xl font-bold text-primary-600">{stat.number}</span>
            <span class="mt-2 text-gray-600 stat-label">{stat.label}</span>
          </div>
        ))}
      </div>
    </div>
  </div>

  <!-- Values Section -->
  <div class="bg-gray-50 py-24">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="text-center mb-16">
        <span class="text-primary-600 font-semibold text-sm uppercase tracking-wider">Meet Benjamin</span>
        <h2 class="mt-2 text-5xl font-extrabold text-gray-900 leading-tight">
          Switzerland's Trusted Insurance<br/>Partner for Expats
        </h2>
        <div class="mt-4 max-w-3xl mx-auto">
          <p class="text-xl text-gray-500">Expert insurance guidance that puts expats first.</p>
        </div>
      </div>

      <div class="grid grid-cols-1 lg:grid-cols-2 gap-16 items-center">
        <div class="space-y-10">
          {valuePoints.map(point => (
            <div class="flex gap-6">
              <div class="flex-shrink-0">
                <div class="flex items-center justify-center h-16 w-16 rounded-full bg-primary-100 text-primary-600">
                  <Fragment set:html={point.icon} />
                </div>
              </div>
              <div>
                <h3 class="text-xl font-semibold text-gray-900 mb-3">{point.title}</h3>
                <p class="text-gray-600 leading-relaxed">{point.description}</p>
              </div>
            </div>
          ))}
        </div>

        <div class="relative lg:mt-0 mt-10">
          <div class="relative">
            <img 
              src="https://res.cloudinary.com/dphbnwjtx/image/upload/c_fill,g_center,h_700,w_600,y_20,e_improve,e_sharpen,r_20/v1747850395/DSC_7067_l2xm3b.webp"
              srcset="https://res.cloudinary.com/dphbnwjtx/image/upload/c_fill,g_center,h_420,w_350,y_20,e_improve,e_sharpen,r_20/v1747850395/DSC_7067_l2xm3b.webp 350w,
                      https://res.cloudinary.com/dphbnwjtx/image/upload/c_fill,g_center,h_660,w_550,y_20,e_improve,e_sharpen,r_20/v1747850395/DSC_7067_l2xm3b.webp 550w,
                      https://res.cloudinary.com/dphbnwjtx/image/upload/c_fill,g_center,h_780,w_650,y_20,e_improve,e_sharpen,r_20/v1747850395/DSC_7067_l2xm3b.webp 650w"
              sizes="(max-width: 640px) 320px, (max-width: 1024px) 500px, 600px"
              loading="lazy"
              fetchpriority="low"
              decoding="async"
              alt="Benjamin Wagner - Insurance Expert"
              class="w-full max-w-lg mx-auto rounded-3xl shadow-2xl object-cover object-center"
              style="max-height: 550px; width: auto;"
              width="600" 
              height="700"
            />
            <div class="absolute -bottom-6 -right-6 bg-white text-gray-900 px-8 py-4 rounded-xl shadow-xl">
              <div class="flex items-center gap-3">
                <div class="flex-shrink-0">
                  <svg class="h-6 w-6 text-primary-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" />
                  </svg>
                </div>
                <div>
                  <p class="font-bold text-lg">Benjamin Wagner</p>
                  <p class="text-sm text-gray-600">Founder</p>
                </div>
              </div>
            </div>
          </div>
          <div class="absolute -z-10 inset-0 bg-gradient-to-r from-primary-100 to-primary-50 transform rotate-3 rounded-2xl"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- Why Expat-Savvy Bridge Section -->
  <div class="bg-gradient-to-b from-gray-50 to-white py-16 md:py-20">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="text-center mb-16">
        <h2 id="why-expat-savvy-title" class="text-4xl md:text-5xl font-extrabold text-gray-900 leading-tight mb-4">
          Why Expats Trust Expat-Savvy.ch
        </h2>
        <p class="text-xl text-gray-600 max-w-3xl mx-auto">
          Independent, expert insurance guidance tailored to life in Switzerland.
        </p>
      </div>

      <ul role="list" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8 md:gap-10 mb-16">
        {whyExpatSavvyPoints.map(point => (
          <li role="listitem" class="group text-center rounded-2xl p-4 transition-all duration-200 hover:-translate-y-0.5 hover:shadow-[0_8px_24px_rgba(0,0,0,.08)] motion-reduce:transition-none motion-reduce:hover:transform-none">
            <div class="flex items-center justify-center h-12 w-12 rounded-full bg-red-50 text-red-600 mx-auto mb-4 shadow-[inset_0_0_0_1px_rgba(239,68,68,.08)]">
              <Fragment set:html={point.icon} aria-hidden="true" />
            </div>
            <h3 class="text-lg font-semibold text-gray-900 mb-3">{point.title}</h3>
            <p class="text-gray-600 leading-relaxed">{point.description}</p>
          </li>
        ))}
      </ul>

      <div class="flex flex-col md:flex-row gap-4 justify-center items-center">
        <button
          data-open-consultation="true"
          data-consultation-type="new-health"
          data-consultation-title="Setting Up New Insurance"
          aria-label="Set up new insurance with Expat-Savvy - open consultation booking"
          class="inline-flex items-center justify-center px-6 md:px-8 py-3 border border-transparent text-lg font-medium rounded-2xl text-white bg-red-600 hover:bg-red-700 active:bg-red-800 transition-all duration-200 hover:-translate-y-0.5 hover:shadow-[0_8px_28px_rgba(0,0,0,.12)] focus-visible:ring-2 focus-visible:ring-red-500 focus-visible:ring-offset-2 min-w-[250px] motion-reduce:transition-none motion-reduce:hover:transform-none"
        >
          Set Up New Insurance
          <svg class="ml-2 h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 5l7 7m0 0l-7 7m7-7H3" />
          </svg>
        </button>
        <button
          data-open-consultation="true"
          data-consultation-type="change-health"
          data-consultation-title="Reviewing Current Insurance"
          aria-label="Review existing insurance with Expat-Savvy - open consultation booking"
          class="inline-flex items-center justify-center px-6 md:px-8 py-3 border-2 border-red-500 text-lg font-medium rounded-2xl text-red-700 bg-white hover:bg-red-50 transition-all duration-200 hover:-translate-y-0.5 hover:shadow-[0_8px_28px_rgba(0,0,0,.12)] focus-visible:ring-2 focus-visible:ring-red-500 focus-visible:ring-offset-2 min-w-[250px] motion-reduce:transition-none motion-reduce:hover:transform-none"
        >
          Review Existing Insurance
          <svg class="ml-2 h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2" />
          </svg>
        </button>
      </div>

      <div class="text-center mt-6">
        <p class="text-sm text-gray-500">Free, impartial consultation. No obligations.</p>
      </div>
    </div>
  </div>

  <!-- Insurance Solutions Section -->
  <div class="relative bg-white py-24">
    <!-- Background Pattern -->
    <div class="absolute inset-0 pointer-events-none">
      <div class="absolute inset-0 opacity-[0.03]" 
        style={{
          backgroundImage: `url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg stroke='%23cc242c' stroke-width='2'%3E%3Cpath d='M30 5v50M5 30h50'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E")`,
          backgroundSize: '60px 60px',
          maskImage: 'linear-gradient(to bottom, transparent, black, transparent)'
        }} 
      />
    </div>

    <!-- Content Container -->
    <div class="relative z-10 max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="text-center mb-16">
        <span class="text-primary-600 font-semibold text-sm uppercase tracking-wider">Our Insurance Solutions</span>
        <h2 class="mt-2 text-3xl md:text-5xl font-extrabold text-gray-900 leading-tight">
          Expert Guidance for Your<br class="hidden sm:block"/>Life in Switzerland
        </h2>
        <div class="mt-4 max-w-3xl mx-auto">
          <p class="text-lg md:text-xl text-gray-500">Comprehensive insurance solutions tailored to your unique needs as an expat in Switzerland.</p>
        </div>
      </div>

      <!-- Bento Grid -->
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6 group/bento">
        <!-- Health Insurance Box -->
        <div class="group relative bg-white rounded-2xl shadow-md transition-all duration-500 ease-in-out hover:shadow-xl hover:scale-[1.02] group-hover/bento:opacity-50 hover:!opacity-100 hover:z-10 md:row-span-2">
          <div class="p-6 md:p-8 h-full flex flex-col">
            <div class="flex items-center gap-4 mb-6">
              <div class="flex-shrink-0">
                <div class="flex items-center justify-center h-12 w-12 md:h-14 md:w-14 rounded-full bg-gray-100">
                  <svg class="h-6 w-6 md:h-8 md:w-8 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z" />
                  </svg>
                </div>
              </div>
              <h3 class="text-xl md:text-2xl font-bold text-gray-900">Health Insurance</h3>
            </div>
            <p class="text-sm md:text-base text-gray-600 leading-relaxed">Navigate Swiss healthcare with confidence. We help you understand and compare basic and supplementary health insurance options to find your perfect coverage.</p>
            
            <div class="mt-6 md:mt-8 grid grid-cols-1 sm:grid-cols-2 gap-4">
              <a 
                href="/healthcare/new-health-insurance"
                class="bg-gray-50 rounded-xl p-4 md:p-6 transition-all duration-300 hover:shadow-md hover:bg-gray-100"
              >
                <div class="flex items-start">
                  <div class="flex-shrink-0">
                    <div class="flex items-center justify-center h-12 w-12 rounded-md bg-primary-100 text-primary-600">
                      <svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6" />
                      </svg>
                    </div>
                  </div>
                  <div class="ml-4">
                    <h3 class="text-lg font-medium text-gray-900">Setting Up Insurance</h3>
                    <p class="mt-1 text-gray-600">New to Switzerland? We guide you through mandatory insurance setup.</p>
                  </div>
                </div>
              </a>

              <a 
                href="/healthcare/switching-health-insurance"
                class="bg-gray-50 rounded-xl p-4 md:p-6 transition-all duration-300 hover:shadow-md hover:bg-gray-100"
              >
                <div class="flex items-start">
                  <div class="flex-shrink-0">
                    <div class="flex items-center justify-center h-12 w-12 rounded-md bg-primary-100 text-primary-600">
                      <svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4" />
                      </svg>
                    </div>
                  </div>
                  <div class="ml-4">
                    <h3 class="text-lg font-medium text-gray-900">Switch & Save</h3>
                    <p class="mt-1 text-gray-600">Already insured? Compare options and find better rates.</p>
                  </div>
                </div>
              </a>
            </div>

            <div class="mt-6 md:mt-auto pt-4 md:pt-8 flex flex-col sm:flex-row gap-3 md:gap-4">
              <a href="/compare-providers" class="flex-1 inline-flex items-center justify-center px-4 md:px-6 py-2 md:py-3 border border-transparent text-sm md:text-base font-medium rounded-lg text-white bg-primary-600 hover:bg-primary-700 transition-all duration-300 shadow-sm hover:shadow-md">
                Compare Providers
              </a>
              <a href="/ai-chat" class="flex-1 inline-flex items-center justify-center px-4 md:px-6 py-2 md:py-3 border border-gray-300 text-sm md:text-base font-medium rounded-lg text-gray-700 bg-white hover:bg-gray-50 transition-all duration-300 shadow-sm hover:shadow-md">
                Calculate Premium
              </a>
            </div>
          </div>
        </div>

        <!-- Special Situations Box -->
        <div class="group relative bg-white rounded-2xl shadow-md transition-all duration-500 ease-in-out hover:shadow-xl hover:scale-[1.02] group-hover/bento:opacity-50 hover:!opacity-100 hover:z-10">
          <div class="p-6 md:p-8 h-full flex flex-col">
            <div class="flex items-center gap-4 mb-6">
              <div class="flex-shrink-0">
                <div class="flex items-center justify-center h-12 w-12 md:h-14 md:w-14 rounded-full bg-gray-100">
                  <svg class="h-6 w-6 md:h-8 md:w-8 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z" />
                  </svg>
                </div>
              </div>
              <h3 class="text-xl md:text-2xl font-bold text-gray-900">Special Situations</h3>
            </div>
            
            <div class="grid grid-cols-2 gap-4">
              <a href="/insurance-guides/cross-border-insurance" class="bg-gray-50 rounded-lg p-4 hover:bg-gray-100 transition-colors">
                <h4 class="font-medium text-gray-900">Cross-Border Workers</h4>
                <p class="text-sm text-gray-600 mt-1">Insurance for international commuters</p>
              </a>
              <a href="/insurance-guides/student-insurance" class="bg-gray-50 rounded-lg p-4 hover:bg-gray-100 transition-colors">
                <h4 class="font-medium text-gray-900">Students</h4>
                <p class="text-sm text-gray-600 mt-1">Special coverage for studies</p>
              </a>
              <a href="/insurance-guides/self-employed-insurance" class="bg-gray-50 rounded-lg p-4 hover:bg-gray-100 transition-colors">
                <h4 class="font-medium text-gray-900">Self-Employed</h4>
                <p class="text-sm text-gray-600 mt-1">Business protection needs</p>
              </a>
              <a href="/insurance-guides/family-insurance-planning" class="bg-gray-50 rounded-lg p-4 hover:bg-gray-100 transition-colors">
                <h4 class="font-medium text-gray-900">Families</h4>
                <p class="text-sm text-gray-600 mt-1">Coverage for the whole family</p>
              </a>
            </div>
          </div>
        </div>

        <!-- AI Assistant Box -->
        <div class="group relative bg-white rounded-2xl shadow-md transition-all duration-500 ease-in-out hover:shadow-xl hover:scale-[1.02] group-hover/bento:opacity-50 hover:!opacity-100 hover:z-10">
          <div class="p-6 md:p-8 h-full flex flex-col">
            <div class="flex items-center gap-4 mb-6">
              <div class="flex-shrink-0">
                <div class="flex items-center justify-center h-12 w-12 md:h-14 md:w-14 rounded-full bg-gray-100">
                  <svg class="h-6 w-6 md:h-8 md:w-8 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z" />
                  </svg>
                </div>
              </div>
              <h3 class="text-xl md:text-2xl font-bold text-gray-900">AI Assistant</h3>
            </div>
            
            <p class="text-gray-600 mb-6">Get instant answers to your insurance questions, calculate premiums, and compare coverage options 24/7.</p>
            
            <div class="mt-auto">
              <a 
                href="/ai-chat"
                class="w-full inline-flex items-center justify-center px-6 py-3 border border-transparent text-base font-medium rounded-lg text-white bg-primary-600 hover:bg-primary-700 transition-colors"
              >
                Chat with AI Assistant
                <svg class="ml-2 h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 5l7 7m0 0l-7 7m7-7H3" />
                </svg>
              </a>
            </div>
          </div>
        </div>

        <!-- Additional Coverage Box -->
        <div class="group relative bg-white rounded-2xl shadow-md transition-all duration-500 ease-in-out hover:shadow-xl hover:scale-[1.02] group-hover/bento:opacity-50 hover:!opacity-100 hover:z-10 col-span-1 md:col-span-2">
          <div class="p-6 md:p-8 h-full flex flex-col">
            <div class="flex items-center gap-4 mb-6">
              <div class="flex-shrink-0">
                <div class="flex items-center justify-center h-12 w-12 md:h-14 md:w-14 rounded-full bg-gray-100">
                  <svg class="h-6 w-6 md:h-8 md:w-8 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z" />
                  </svg>
                </div>
              </div>
              <h3 class="text-xl md:text-2xl font-bold text-gray-900">Additional Coverage</h3>
            </div>
            
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
              <a href="/insurance/household-insurance" class="bg-gray-50 rounded-lg p-4 hover:bg-gray-100 transition-colors">
                <h4 class="font-medium text-gray-900">Household</h4>
                <p class="text-sm text-gray-600 mt-1">Protect your belongings</p>
              </a>
              <a href="/insurance/personal-liability-insurance" class="bg-gray-50 rounded-lg p-4 hover:bg-gray-100 transition-colors">
                <h4 class="font-medium text-gray-900">Liability</h4>
                <p class="text-sm text-gray-600 mt-1">Personal protection</p>
              </a>
              <a href="/life-insurance" class="bg-gray-50 rounded-lg p-4 hover:bg-gray-100 transition-colors">
                <h4 class="font-medium text-gray-900">Life Insurance</h4>
                <p class="text-sm text-gray-600 mt-1">Family security</p>
              </a>
              <a href="/3rd-pillar" class="bg-gray-50 rounded-lg p-4 hover:bg-gray-100 transition-colors">
                <h4 class="font-medium text-gray-900">3rd Pillar</h4>
                <p class="text-sm text-gray-600 mt-1">Retirement planning</p>
              </a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Featured Guides Section (DYNAMIC BLOG POSTS) -->
  <div class="bg-white py-24">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="text-center mb-16">
        <span class="text-primary-600 font-semibold text-sm uppercase tracking-wider">Expert Resources</span>
        <h2 class="mt-2 text-3xl md:text-5xl font-extrabold text-gray-900 leading-tight">
          Comprehensive Guides for Expats
        </h2>
        <div class="mt-4 max-w-3xl mx-auto">
          <p class="text-lg md:text-xl text-gray-500">Practical advice and insights to help you navigate insurance and life in Switzerland</p>
        </div>
      </div>

      <div class="relative overflow-hidden">
        <!-- Dynamic blog posts container -->
        <div id="blog-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
          {getRandomPosts(validPosts, 3).map((post) => (
            <div class="bg-white rounded-xl overflow-hidden blog-post-card">
              <a href={`/blog/${post.slug}`} class="block">
            <div class="h-48 bg-gray-100">
              <img 
                    src={post.data.image || defaultBlogImage} 
                loading="lazy"
                    alt={`Illustration for ${post.data.title || 'Expat Savvy Article'}`} 
                    class="w-full h-full object-cover transition-opacity duration-500"
              />
            </div>
            <div class="p-6">
                  {post.data.date && (
                    <div class="text-sm text-gray-500 mb-2 blog-post-date">
                      {formatDate(post.data.date)}
              </div>
                  )}
                  <h3 class="text-base font-bold text-gray-900 mb-3 leading-tight blog-post-title" style="min-height: 3rem; display: -webkit-box; -webkit-line-clamp: 3; -webkit-box-orient: vertical; overflow: hidden;">{post.data.title || 'Expat Savvy Article'}</h3>
                  {post.data.description && (
                    <p class="text-gray-600 mb-4 line-clamp-3 blog-post-description">{post.data.description}</p>
                  )}
              <div class="flex items-center text-primary-500 font-medium">
                Read guide
                <svg class="ml-1 w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 5l7 7m0 0l-7 7m7-7H3" />
                </svg>
              </div>
            </div>
          </a>
        </div>
          ))}
        </div>
      </div>

      <div class="mt-12 text-center">
        <a href="/blog" class="inline-flex items-center px-6 py-3 border border-gray-300 shadow-sm text-base font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 transition-colors">
          View all guides
          <svg class="ml-2 h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3" />
          </svg>
        </a>
      </div>
    </div>
  </div>

  <!-- Testimonials Section -->
  <Testimonials />

  <!-- Contact Section -->
  <div class="bg-white py-24">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="max-w-3xl mx-auto text-center">
        <h2 class="text-3xl font-extrabold text-gray-900 mb-8">Get Started Today</h2>
        <p class="text-xl text-gray-500 mb-8">
          Ready to simplify your insurance journey? Schedule your free consultation or chat with us on WhatsApp.
        </p>
        <div class="flex flex-col sm:flex-row gap-4 justify-center">
          <button
            data-open-consultation="true"
            class="inline-flex items-center justify-center px-6 py-3 border border-transparent text-base font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 transition-colors"
            onclick="event.preventDefault(); if(typeof window.openOffersModal === 'function') { window.openOffersModal(); } else { const modal = document.getElementById('offers-modal'); if(modal) { modal.classList.remove('hidden'); document.body.classList.add('modal-open'); } } return false;"
          >
            Schedule Free Consultation
            <svg class="ml-2 h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
            </svg>
          </button>
          
          <a
            href="https://wa.me/41791552570"
            target="_blank"
            rel="noopener noreferrer"
            class="inline-flex items-center justify-center px-6 py-3 border border-transparent text-base font-medium rounded-md text-white bg-[#128C7E] hover:bg-[#075E54] transition-colors"
          >
            <svg class="h-5 w-5 mr-2" fill="currentColor" viewBox="0 0 24 24">
              <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"/>
            </svg>
            Chat on WhatsApp
          </a>
        </div>
      </div>
    </div>
  </div>
</Layout>

<script>
  // Update booking count every 10 minutes
  function updateBookingCount() {
    const countElement = document.getElementById('booking-count');
    const countElementDesktop = document.getElementById('booking-count-desktop');
    if (countElement) {
      const randomCount = Math.floor(Math.random() * (11 - 3 + 1)) + 3; // Random number between 3-11
      const text = `${randomCount} people booked a consultation in the last 24 hours`;
      countElement.textContent = text;
      if (countElementDesktop) {
        countElementDesktop.textContent = text;
      }
    }
  }

  // Simple blog slider functionality
  function initializeBlogSlider() {
    const container = document.getElementById('blog-container');
    
    if (!container) {
      console.warn('Blog container not found');
      return;
    }
    
    // Get all blog posts data from the JSON script tag
    const blogDataElement = document.getElementById('blog-posts-data');
    if (!blogDataElement) {
      console.warn('Blog posts data not found');
      return;
    }
    
    let allPosts: Array<{slug: string, title: string, description: string, image: string, date: string}>;
    try {
      allPosts = JSON.parse(blogDataElement.textContent || '[]');
    } catch (e) {
      console.error('Failed to parse blog posts data:', e);
      return;
    }
    
    if (!allPosts || allPosts.length === 0) {
      console.warn('No blog posts available');
      return;
    }
    
    // Track which card to update next (sequential rotation)
    let currentCardIndex = 0;
    
    function getCurrentlyVisibleSlugs() {
      const cards = container!.querySelectorAll('.blog-post-card');
      return Array.from(cards).map(card => {
        const link = card.querySelector('a[href*="/blog/"]');
        return link ? link.getAttribute('href')?.split('/').pop() : null;
      }).filter((slug): slug is string => slug !== null);
    }
    
    function getRandomAvailablePost() {
      const currentlyVisible = getCurrentlyVisibleSlugs();
      
      // Find posts that are not currently visible
      const availablePosts = allPosts.filter((post: any) => !currentlyVisible.includes(post.slug));
      
      if (availablePosts.length === 0) {
        // Fallback: if somehow all posts are visible (shouldn't happen with 3 cards), use any post
        return allPosts[Math.floor(Math.random() * allPosts.length)];
      }
      
      return availablePosts[Math.floor(Math.random() * availablePosts.length)];
    }
    
    function updateNextCard() {
      // Performance check: only animate if page is visible
      if (document.hidden) return;
      
      const cards = container!.querySelectorAll('.blog-post-card');
      if (cards.length === 0) return;
      
      // Use sequential rotation: card 0, then card 1, then card 2, then back to 0
      const card = cards[currentCardIndex] as HTMLElement;
      currentCardIndex = (currentCardIndex + 1) % cards.length;
      
      const newPost = getRandomAvailablePost();
      
      if (!newPost) return;
      
      // Get card elements
      const image = card.querySelector('img');
      const dateEl = card.querySelector('.blog-post-date');
      const titleEl = card.querySelector('.blog-post-title');
      const descriptionEl = card.querySelector('.blog-post-description');
      const link = card.querySelector('a');
      
      if (!image || !titleEl || !link) return;
      
      // Fade out
      card.style.opacity = '0.3';
      
      setTimeout(() => {
        // Update content
        const defaultImage = "https://res.cloudinary.com/dphbnwjtx/image/upload/v1746849106/a-hand-drawn-style-illustration-of-a-swi_q72d2DQuS9GBc1WmPIaaCw_008krU2iTMW5Xa_C75c0rQ_ud00f1.webp";
        const newImageSrc = newPost.image || defaultImage;
        
        // Update image
        image.src = newImageSrc;
        image.alt = `Illustration for ${newPost.title || 'Expat Savvy Article'}`;
        
        // Update link
        link.href = `/blog/${newPost.slug}`;
        
        // Update date
        if (dateEl && newPost.date) {
          try {
            const dateObj = new Date(newPost.date);
            if (!isNaN(dateObj.valueOf())) {
              dateEl.textContent = dateObj.toLocaleDateString('en-US', {
                year: 'numeric',
                month: 'long',
                day: 'numeric'
              });
            }
          } catch (e) {
            if (dateEl) dateEl.textContent = '';
          }
        }
        
        // Update title
        titleEl.textContent = newPost.title || 'Expat Savvy Article';
        
        // Update description
        if (descriptionEl) {
          descriptionEl.textContent = newPost.description || '';
        }
        
        // Fade back in
        card.style.opacity = '1';
      }, 300);
    }

    // Set up automatic rotation every 8 seconds
    setInterval(updateNextCard, 8 * 1000);
  }

  // Initial updates
  updateBookingCount();
  initializeBlogSlider();

  // Set up intervals
  setInterval(updateBookingCount, 10 * 60 * 1000); // Update booking count every 10 minutes
</script>

<!-- Hidden script tag to pass blog data to JavaScript -->
<script type="application/json" id="blog-posts-data" set:html={JSON.stringify(allPostsForRotation)}></script>

<style>
  /* Special styling for the booking count animation */
  @keyframes pulse {
    0% { opacity: 0.7; }
    50% { opacity: 1; }
    100% { opacity: 0.7; }
  }
  
  .animate-pulse {
    animation: pulse 2s infinite;
  }
  
  /* Motion safety for reduced motion preferences */
  @media (prefers-reduced-motion: reduce) {
    /* Disable all hover transforms and animations */
    .hover\\:-translate-y-0\\.5:hover,
    .group:hover .group-hover\\:-translate-y-0\\.5,
    .transition-all,
    .transition,
    .duration-200,
    .animate-pulse {
      transition: none !important;
      animation: none !important;
      transform: none !important;
    }
    
    /* Keep only basic hover effects like color changes */
    .hover\\:bg-red-700:hover {
      background-color: rgb(185 28 28);
    }
    
    .hover\\:bg-red-50:hover {
      background-color: rgb(254 242 242);
    }
    
    .hover\\:shadow-\\[0_8px_24px_rgba\\(0\\,0\\,0\\,\\.08\\)\\]:hover,
    .hover\\:shadow-\\[0_8px_28px_rgba\\(0\\,0\\,0\\,\\.12\\)\\]:hover {
      box-shadow: none !important;
    }
  }
  
  /* Support for hero text animations */
  .animate-fade-in {
    animation: fadeIn 1s ease-out;
  }
  
  @keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
  }
  
  .animate-slide-up {
    animation: slideUp 0.8s ease-out;
    animation-fill-mode: both;
  }
  
  @keyframes slideUp {
    from { 
      opacity: 0;
      transform: translateY(20px);
    }
    to { 
      opacity: 1;
      transform: translateY(0);
    }
  }
  
  .text-shadow {
    text-shadow: 0 2px 4px rgba(0,0,0,0.3);
  }
  
  /* Line clamp for text truncation */
  .line-clamp-3 {
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
  
  /* Enhanced blog card shadows */
  .blog-post-card {
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    transform: translateZ(0); /* Force hardware acceleration */
    border-radius: 0.75rem; /* Explicit border radius */
  }
  
  .blog-post-card:hover {
    box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
    transform: translateY(-4px) translateZ(0); /* Remove scale, keep lift */
    border-radius: 0.75rem; /* Maintain border radius on hover */
  }
  
  /* Subtle border for extra polish */
  .blog-post-card {
    border: 1px solid rgba(0, 0, 0, 0.05);
  }
  
  /* Fix mobile gaps */
  @media (max-width: 640px) {
    .trust-indicators {
      padding-top: 1rem;
      padding-bottom: 1rem;
    }
    
    /* Ensure hero section fills screen properly on mobile */
    .hero-section {
      min-height: calc(100vh - 65px);
      height: auto !important;
      max-height: none !important;
    }
    
    /* Handle iPhone notch area */
    @supports (padding-top: env(safe-area-inset-top)) {
      .hero-section {
        padding-top: env(safe-area-inset-top);
        padding-bottom: env(safe-area-inset-bottom);
      }
    }
  }
  
  /* Fix for specific mobile devices */
  @media (max-width: 380px) {
    .hero-section {
      min-height: 100vh;
    }
    
    h1 {
      font-size: 1.75rem !important;
    }
    
    .hero-section button {
      padding: 0.5rem 1rem;
    }
  }
</style>

<!-- Emergency Inline Button Fix -->
<script is:inline>
  // This script directly targets the problematic buttons on this page
  // and fixes them with a direct approach bypassing all event systems
  
  console.log("[EMERGENCY] Loading inline button fix for homepage");
  
  function fixHomePageButtons() {
    console.log("[EMERGENCY] Running homepage button fix");
    
    // Fix hero section button
    const heroButtons = document.querySelectorAll('.hero-section button, .hero-section a');
    heroButtons.forEach(button => {
      const text = button.textContent?.trim();
      if (!text) return;
      
      if (text.includes('Book Free') || text.includes('Consultation')) {
        console.log(`[EMERGENCY] Found hero button with text: ${text}`);
        
        // Replace the entire button with a new one
        const newButton = document.createElement('button');
        newButton.innerHTML = button.innerHTML;
        newButton.className = button.className;
        newButton.style.cursor = 'pointer';
        
        // Copy attributes except for listeners
        for (let i = 0; i < button.attributes.length; i++) {
          const attr = button.attributes[i];
          if (attr.name !== 'onclick' && attr.name !== 'data-open-consultation') {
            newButton.setAttribute(attr.name, attr.value);
          }
        }
        
        // Add our own direct click handler
        newButton.onclick = function(e) {
          e.preventDefault();
          e.stopPropagation();
          console.log("[EMERGENCY] Hero button clicked");
          
          // Show the modal directly
          const modal = document.getElementById('consultation-modal');
          if (modal) {
            modal.classList.remove('hidden');
            document.body.classList.add('modal-open');
          } else if (typeof window.showConsultationModal === 'function') {
            window.showConsultationModal();
          }
        };
        
        // Replace the original button with our new one
        if (button.parentNode) {
          button.parentNode.replaceChild(newButton, button);
          console.log("[EMERGENCY] Successfully replaced hero button");
        }
      }
    });
    
    // Fix the "Get Started Today" bottom section button
    const allButtons = document.querySelectorAll('button, a');
    allButtons.forEach(button => {
      const text = button.textContent?.trim();
      if (!text) return;
      
      if (text === "Schedule Free Consultation") {
        console.log("[EMERGENCY] Found 'Get Started Today' button");
        
        // Replace with new button
        const newButton = document.createElement('button');
        newButton.innerHTML = button.innerHTML;
        newButton.className = button.className;
        newButton.style.cursor = 'pointer';
        
        // Copy attributes except for listeners
        for (let i = 0; i < button.attributes.length; i++) {
          const attr = button.attributes[i];
          if (attr.name !== 'onclick' && attr.name !== 'data-open-consultation') {
            newButton.setAttribute(attr.name, attr.value);
          }
        }
        
        // Add our own direct click handler
        newButton.onclick = function(e) {
          e.preventDefault();
          e.stopPropagation();
          console.log("[EMERGENCY] Get Started Today button clicked");
          
          // Show the modal directly
          const modal = document.getElementById('consultation-modal');
          if (modal) {
            modal.classList.remove('hidden');
            document.body.classList.add('modal-open');
          } else if (typeof window.showConsultationModal === 'function') {
            window.showConsultationModal();
          }
        };
        
        // Replace the original button with our new one
        if (button.parentNode) {
          button.parentNode.replaceChild(newButton, button);
          console.log("[EMERGENCY] Successfully replaced Get Started Today button");
        }
      }
    });
    
    // Add global click handler for these specific buttons
    document.addEventListener('click', function(e) {
      // Look for clicks on or within consultation-related elements
      let target = e.target;
      let text = target.textContent?.trim();
      
      // Check if the click is on a button or within a button
      if (text && (text.includes('Book Free') || text.includes('Consultation') || text.includes('Schedule'))) {
        console.log(`[EMERGENCY] Click detected on text: ${text}`);
        
        // Find the closest button or link
        const button = target.closest('button, a');
        if (button) {
          const buttonText = button.textContent?.trim();
          console.log(`[EMERGENCY] Found button/link with text: ${buttonText}`);
          
          if (buttonText && (
            buttonText.includes('Book Free Consultation') || 
            buttonText.includes('Schedule Free Consultation')
          )) {
            console.log('[EMERGENCY] Intercepting button click');
            e.preventDefault();
            e.stopPropagation();
            
            // Show new offers modal
            if (typeof window.openOffersModal === 'function') {
              window.openOffersModal();
            } else {
              const modal = document.getElementById('offers-modal');
              if (modal) {
                modal.classList.remove('hidden');
                document.body.classList.add('modal-open');
              }
            }
            
            return false;
          }
        }
      }
    }, true); // Use capturing phase for highest priority
  }

  // Run immediately and also after DOM is fully loaded
  if (document.readyState === 'complete' || document.readyState === 'interactive') {
    setTimeout(fixHomePageButtons, 1);
  } else {
    document.addEventListener('DOMContentLoaded', fixHomePageButtons);
  }
  
  // Also run after full page load and with some delays
  window.addEventListener('load', fixHomePageButtons);
  setTimeout(fixHomePageButtons, 500);
  setTimeout(fixHomePageButtons, 2000);
</script>